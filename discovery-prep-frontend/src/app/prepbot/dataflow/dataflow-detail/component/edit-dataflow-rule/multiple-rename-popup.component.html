<!--
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<div class="pb-layout-popup" *ngIf="isPopupOpen">
  <!-- box popup -->
  <div class="pb-box-popup">
    <!-- top -->
    <div class="pb-popup-top">
      <div class="pb-txt-title">Rename</div>
      <div class="pb-ui-buttons">
        <div class="pb-ui-part">
          <a href="javascript:" class="pb-component-btn type-line"
             [ngClass]="{'ddp-disabled': errorEsg }" (click)="applyRename()">
            <em class="pb-icon-add-r"></em>{{ getButtonLabel() }}</a>
        </div>
      </div>
      <a href="javascript:" class="pb-btn-pop-close" (click)="close()"></a>
    </div>
    <!-- //top -->
    <!-- contents -->
    <div class="pb-popup-contents pb-pop-information">
      <!-- option -->
      <div class="pb-ui-data-option ">

        <div class="pb-page-rename">
          <div class="pb-wrap-rename">
            <!-- result -->
            <div class="pb-result">
              <span class="pb-col">{{gridData?.fields.length}} column(s)</span>
              <span class="pb-name" title="{{datasetName}}">{{datasetName}}</span>
            </div>
            <!-- //result -->
            <!-- column -->
            <div class="pb-wrap-list">

              <table class="pb-table-column">
                <colgroup>
                  <col width="50%">
                  <col width="50%">
                </colgroup>
                <thead>
                <tr>
                  <th>{{'msg.dp.ui.before' | translate}}</th>
                  <th>{{'msg.dp.ui.after' | translate}}</th>
                </tr>
                </thead>
                <tbody>
                <!-- 수정될때 pb-selected 추가 -->
                <tr *ngFor="let column of columns; let index = index"
                    [ngClass]="{'pb-selected': isChanged(column) || isEditing(column),
                  'pb-edit':isChanged(column)}">
                  <td>
                    <span class="pb-txt-column">{{gridData.fields[index].name}}</span>
                    <em class="pb-view"></em>
                  </td>
                  <td>
                    <!-- edit -->
                    <!-- 클릭시 pb-selected 추가 -->
                    <div class="pb-box-edit"
                         [ngClass]="{'pb-selected': isEditing(column)}"
                         (click)="editItem(column, index, renamedAsColumns)">
                      <input type="text" [(ngModel)]="column.renamedAs"
                             (keydown)="onKeydownHandler($event, column)"
                             (keyup.enter)="applyRename()"
                             (focus)="focus(column)"
                             #renamedAsColumns
                             (focusout)="focusOut(column,index, $event, renamedAsColumns)">
                      <em class="pb-icon-edit"></em>
                    </div>
                    <!-- //edit -->
                    <span class="pb-txt-error" *ngIf="column.isError"><em class="pb-icon-error"></em>{{errorEsg}}</span>
                  </td>
                </tr>
                </tbody>
              </table>
            </div>
            <!-- //column -->
            <!-- grid -->
            <div class="pb-wrap-grid">
              <div class="pb-ui-grid">
                <div scroll-grid-component style="width:100%; height: 100%;"></div>
              </div>
            </div>
            <!-- //grid -->
          </div>
        </div>

      </div>
      <!-- //option -->
    </div>
    <!-- //contents -->
    <!-- bottom -->
    <div class="pb-popup-bottom">
      <a href="javascript:" class="pb-component-btn-pop type-line" (click)="close()">{{'msg.comm.btn.cancl' | translate}}</a>
      <a href="javascript:" class="pb-component-btn-pop type-bg"
         [ngClass]="{'ddp-disabled': errorEsg }" (click)="applyRename()">{{ getButtonLabel() }}</a>
    </div>
    <!-- //bottom -->
  </div>
  <!-- //box popup -->
</div>
