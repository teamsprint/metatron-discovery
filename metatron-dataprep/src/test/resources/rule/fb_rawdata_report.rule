settype col: rows type: array
flatten col: rows
settype col: rows type: map
unnest col: rows into: MAP idx: 'account_currency','account_id','account_name','actions','buying_type','campaign_id','campaign_name','clicks','cost_per_action_type','cost_per_estimated_ad_recallers','cost_per_inline_link_click','cost_per_inline_post_engagement','cost_per_outbound_click','cost_per_thruplay','cost_per_unique_action_type','cost_per_unique_click','cost_per_unique_inline_link_click','cost_per_unique_outbound_click','cpc','cpm','cpp','ctr','date_start','date_stop','impressions','frequency','inline_link_click_ctr','inline_link_clicks','inline_post_engagement','instant_experience_clicks_to_open','instant_experience_clicks_to_start','instant_experience_outbound_clicks','objective','outbound_clicks','outbound_clicks_ctr','reach','social_spend','spend','unique_actions','unique_clicks','unique_ctr','unique_inline_link_click_ctr','unique_inline_link_clicks','unique_link_clicks_ctr','unique_outbound_clicks','unique_outbound_clicks_ctr','video_30_sec_watched_actions','video_avg_time_watched_actions','video_p100_watched_actions','video_p25_watched_actions','video_p50_watched_actions','video_p75_watched_actions','video_p95_watched_actions','video_play_actions','video_thruplay_watched_actions','website_ctr','estimated_ad_recallers'
drop col: rows,account_currency,actions,buying_type,cost_per_action_type,cost_per_estimated_ad_recallers,cost_per_inline_link_click,cost_per_inline_post_engagement,cost_per_outbound_click,cost_per_thruplay,cost_per_unique_action_type,cost_per_unique_click,cost_per_unique_inline_link_click,cost_per_unique_outbound_click,date_stop,instant_experience_clicks_to_open,instant_experience_clicks_to_start,instant_experience_outbound_clicks,unique_actions,objective
settype col: date_start type: Timestamp format: 'yyyy-MM-dd'
settype col: outbound_clicks,outbound_clicks_ctr,unique_outbound_clicks,unique_outbound_clicks_ctr,video_30_sec_watched_actions,video_avg_time_watched_actions,video_p100_watched_actions,video_p25_watched_actions,video_p50_watched_actions,video_p75_watched_actions,video_p95_watched_actions,video_play_actions,video_thruplay_watched_actions,website_ctr type: string
replace col: outbound_clicks,outbound_clicks_ctr,unique_outbound_clicks,unique_outbound_clicks_ctr,video_30_sec_watched_actions,video_avg_time_watched_actions,video_p100_watched_actions,video_p25_watched_actions,video_p50_watched_actions,video_p75_watched_actions,video_p95_watched_actions,video_play_actions,video_thruplay_watched_actions,website_ctr with: '$1' on: /.*\"value\":\"([\d.]+)\".*/ global: true ignoreCase: false
settype col: outbound_clicks,outbound_clicks_ctr,unique_outbound_clicks,unique_outbound_clicks_ctr,video_30_sec_watched_actions,video_avg_time_watched_actions,video_p100_watched_actions,video_p25_watched_actions,video_p50_watched_actions,video_p75_watched_actions,video_p95_watched_actions,video_play_actions,video_thruplay_watched_actions,website_ctr type: long
settype col: outbound_clicks_ctr,unique_outbound_clicks_ctr,cpc,cpm,cpp,ctr,frequency,inline_link_click_ctr,unique_ctr,unique_inline_link_click_ctr,unique_link_clicks_ctr,website_ctr type: double
settype col: clicks,impressions,inline_link_clicks,inline_post_engagement,reach,social_spend,spend,unique_clicks,unique_inline_link_clicks,estimated_ad_recallers type: long